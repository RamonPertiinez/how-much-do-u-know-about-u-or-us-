<!doctype html>
<html lang="ca">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tens ganes de saber el teu regal? ğŸ˜</title>
  <meta name="description" content="Joc d'aniversari amb 25 proves i una sorpresa final." />
  <meta name="robots" content="noindex,nofollow" />
  <meta name="theme-color" content="#0f0f14" />

  <!-- âš ï¸ SENSE <base> per evitar rutes trencades a GitHub Pages -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css" />

  <style>
    body{font-family:"Poppins",system-ui,sans-serif;background:#0f1117;color:#e7ecf3;margin:0}
    .view{display:none;padding:20px;max-width:850px;margin:0 auto}
    .view.active{display:block}
    .topbar{display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);padding:12px 18px;border-radius:14px;margin-bottom:22px}
    .brand{font-weight:600;font-size:18px;display:flex;align-items:center;gap:8px}
    .progress{display:flex;align-items:center;gap:8px}
    .bar{width:160px;height:8px;background:#1f2330;border-radius:999px;overflow:hidden;position:relative}
    .fill{position:absolute;left:0;top:0;height:100%;width:0;background:linear-gradient(90deg,#7c87ff,#b388ff);border-radius:inherit;transition:width .35s ease}
    .score{font-weight:700;opacity:.9}
    .card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:18px;margin:16px 0}
    .card h2{margin:0 0 6px;font-size:clamp(18px,2.2vw,22px)}
    .card p{margin:0 0 12px;color:rgba(255,255,255,.8)}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .btn{display:inline-block;padding:8px 12px;border-radius:10px;text-decoration:none;color:#e7ecf3;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.12);transition:background .2s,border-color .2s}
    .btn:hover{background:rgba(255,255,255,.1);border-color:rgba(255,255,255,.3)}
    .btn.primary{background:#5aa9ff;border-color:#5aa9ff;color:#0b1020;font-weight:700}
    .btn.reset{background:#ff6b6b;border-color:#ff6b6b;color:#0b1020;font-weight:700;margin-top:16px}
    #confetti span{position:fixed;width:8px;height:8px;border-radius:2px}
  </style>
</head>
<body>
  <noscript><div style="padding:16px;font-family:Poppins,system-ui">Aquest joc necessita JavaScript. Si us plau, activaâ€™l ğŸ’›</div></noscript>

  <div id="app">
    <!-- 1) GATE (activa per defecte) -->
    <section id="gate" class="view active" aria-label="Porta d'entrada">
      <div class="card gate-card on-image" style="background:rgba(0,0,0,.2)">
        <h1 class="title"><span class="handwritten">TENS GANES DE SABER EL TEU REGAL?</span> ğŸ˜</h1>
        <p class="subtitle">Per entrar has d'encertar la primera pista relacionada amb aquesta foto.</p>

        <form id="loginForm" autocomplete="off" style="margin-top:8px;">
          <label for="username">UsuÃ ria</label>
          <input id="username" name="username" type="text" placeholder="laura" required />
          <label for="password">Contrasenya</label>
          <input id="password" name="password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" required />
          <div style="display:flex;gap:10px;align-items:center;margin-top:10px;">
            <button type="submit" class="btn primary">ComenÃ§ar</button>
            <button type="button" id="btnShowRiddle" class="btn ghost">Veure pista</button>
          </div>
          <p id="loginMsg" class="msg" role="status" aria-live="polite"></p>
        </form>

        <button id="clearCache" class="btn ghost" style="margin:10px 0 0;">ğŸ”„ Reinicia joc</button>

        <!-- (Opcional) Caixa del riddle si la vols fer servir -->
        <div id="riddleBox" class="riddle" style="display:none;">
          <p id="riddleText">Llegeix nomÃ©s les majÃºscules del text que et vaig posarâ€¦ ğŸ˜‰</p>
          <input id="riddleAnswer" type="text" placeholder="Resposta de la pista" />
          <div style="display:flex;gap:8px;margin-top:8px;">
            <button id="riddleSubmit" class="btn primary">Comprovar resposta</button>
            <button id="riddleHint" class="btn">Pista</button>
          </div>
          <p id="riddleMsg" class="hint-text"></p>
        </div>
      </div>
    </section>

    <!-- 2) HUB -->
    <section id="hub" class="view" aria-label="Mapa de proves">
      <header class="topbar">
        <div class="brand">
          <button id="easterReset" class="btn small ghost" aria-label="Opcions ocultes">ğŸ</button>
          <span id="gameTitle">Tens ganes de saber el teu regal?</span>
        </div>
        <div class="progress">
          <div class="bar"><div class="fill" id="progressFill"></div></div>
          <div class="score"><span id="scoreNum">0</span>/<span id="scoreGoal">8</span></div>
        </div>
      </header>

      <!-- Joc 1 -->
      <section class="card">
        <h2>ğŸµ Joc 1 â€” Endevina la canÃ§Ã³</h2>
        <p>Escolta la pista i tria la canÃ§Ã³ correcta. Hi ha 5 canÃ§ons en total.</p>
        <div class="row">
          <a class="btn primary" href="./js/game1/index.html">â–¶ï¸ Obrir Joc 1</a>
        </div>
      </section>

      <!-- Joc 2 -->
      <section class="card">
        <h2>ğŸ“¸ Joc 2 â€” Una foto borrosa</h2>
        <p>Mira un vÃ­deo que sâ€™enfoca a poc a poc i tria el lloc correcte dâ€™un desplegable.</p>
        <div class="row">
          <a class="btn primary" href="./js/game2/index.html">â–¶ï¸ Obrir Joc 2</a>
        </div>
      </section>

      <!-- Joc 3 -->
      <section class="card">
        <h2>ğŸ‘€ Joc 3 â€” Encerta els ulls</h2>
        <p>Endevina a qui pertanyen els ulls triant entre 3 opcions. Hi ha 6 rondes en total.</p>
        <div class="row">
          <a class="btn primary" href="./js/game3/index.html">â–¶ï¸ Obrir Joc 3</a>
        </div>
      </section>

      <!-- BotÃ³ de reset global -->
      <section class="card" style="text-align:center;">
        <h2>ğŸ” Reiniciar tot el joc</h2>
        <p>Si alguna cosa no funciona o vols comenÃ§ar de zero, reinicia.</p>
        <button id="btnFullReset" class="btn reset">Reiniciar i tornar a lâ€™inici</button>
      </section>
    </section>

    <!-- 3) FINAL -->
    <section id="final" class="view" aria-label="Sorpresa final">
      <div class="final-wrap">
        <h1 id="finalHeading">ğŸ‰ Sorpresa desbloquejada!</h1>
        <p id="finalSubheading" class="lead">Has superat les proves del meu cor. Ara prepara'tâ€¦</p>
        <div class="final-card">
          <h2 id="finalTitle"><span class="handwritten">UNA NIT ELEGANT A ROMA</span> ğŸ‡®ğŸ‡¹</h2>
          <p id="finalBody">Al gener, porta la teva roba mÃ©s elegant. Tinc reservat un lloc especial per sopar junts. ğŸ’›</p>
        </div>
        <audio id="finalAudio" class="audio-ctrl" controls preload="none">
          <source src="./assets/audio/final.mp3" type="audio/mpeg" />
        </audio>
        <button id="btnRestart" class="btn">Tornar a comenÃ§ar</button>
      </div>
      <div class="confetti" id="confetti" aria-hidden="true"></div>
    </section>
  </div>

  <!-- JS global -->
  <script src="./js/app.js?v=fix1" defer></script>

  <!-- Reset global -->
  <script>
    document.addEventListener("DOMContentLoaded",()=>{
      const btn = document.getElementById("btnFullReset");
      if(btn){
        btn.addEventListener("click", ()=>{
          if(confirm("Vols reiniciar TOT el joc i tornar a lâ€™inici?")){
            localStorage.clear();
            location.href = "./index.html";
            setTimeout(()=>location.reload(), 150);
          }
        });
      }
    });
  </script>
</body>
</html>
